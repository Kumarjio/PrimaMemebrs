var validator;function myOnEdit(f,d,b,c){if($("#mbr_status_approved:checked").length=="0"||$("#mbr_status_confirmed:checked").length=="0"||$("#mbr_status_suspended:checked").length=="1"){if(!confirm($("#emsg_warning_not_active").html())){return}}d=typeof(d)=="undefined"?"":d;displayMessageEx(false,false,false);displayMessageEx(false,true,false);validator=new FormValidator();var a=$("table.table_pos").find(":input").not(".user_registration_add_field,:button");a.each(function(){validator.add($(this).attr("name"))});if(validator.checkAll()&&add_fields_validator.checkAll()){var e={action:"save"};e.id=f;if(typeof(b)!="undefined"){e.account_id=b}var a=validator.getItems();for(key in a){if(typeof(a[key])!="function"){e[key]=a[key]}}e["groups[]"]=e.groups;delete (e.groups);e=jQuery.extend(e,_get_add_fields());if(isset(c)){e.autofill=true;on_post_error=panel_save_error;on_post_success=function(g){$("#account_panel").html(g);redesign()}}else{on_post_error=panel_save_error;on_post_success=function(h){var g=getTempVarsSet(false,h);if(typeof(g.message)!="undefined"){displayMessageEx(g.message);$("#mbr_name").html(g.name)}else{displayMessageEx(g)}};additional_accept=function(h){var g=getTempVarsSet(false,h);displayMessageEx(g);moveSlideTab("member_list")}}load_panel(base_url+"member/edit_member_info/"+d,e,{"0":base_url+"js/admin/init.js"})}}function after_load_account_edit_form_success(b){try{_change_accnt_panel_tab("tab_member_info");$("#account_panel").html(b);redesign()}catch(a){_sys_error("member_info_update:after_load_account_edit_form_success","Shows the member account edit form",a)}}function load_account_edit_form(){try{var a=$("#mbr_id").val();if(a>0){var c={id:a};on_post_success=after_load_account_edit_form_success;load_panel(base_url+"member/edit_member_info",c);return}}catch(b){_sys_error("member_info_update:load_account_form","Loads member account for for update",b)}}function load_additional_profile_form(c,b){try{var a=$("#mbr_id").val();if(a>0){var f={id:a,account_id:b};on_post_success=function(e){$("#account_panel").html(e);redesign()};_change_accnt_panel_tab("tab_"+c+b);load_panel(base_url+"member/edit_member_info/"+c,f);return}}catch(d){_sys_error("member_info_update:load_domain_info_form","Loads member domain info for for update",d)}}function load_domain_info_form(){try{var a=$("#mbr_id").val();if(a>0){var c={id:a};on_post_success=function(d){$("#account_panel").html(d);redesign()};_change_accnt_panel_tab("tab_domain_info");load_panel(base_url+"member/edit_member_info/domain_info",c);return}}catch(b){_sys_error("member_info_update:load_domain_info_form","Loads member domain info for for update",b)}}function after_save_account_info_success(b){_error_panel_hide();try{temp=b.split("!:sep:!");$("#mbr_name").html(temp[0]);_msg_panel_show(temp[1])}catch(a){_sys_error("member_info_update:after_save_account_info_success","Change member name",a)}}function after_save_account_info_error(b){var a=getTempVarsSet(false,b);if(a.length>0){displayMessageEx(a,true)}else{_msg_panel_hide();if(b!=""){_error_panel_show(b)}}}function save_account_info(){_msg_panel_hide();_error_panel_hide();try{var m=$("#mbr_id").val();if(m>0){var h=$("#mbr_exp_date").val();var f=$("#mbr_email").val();var g=$("#mbr_first_name").val();var k=$("#mbr_last_name").val();var b=$("#mbr_groups").val();var n={id:m,exp_date:h,email:f,name:g,last_name:k,"groups[]":b,action:"save"};var o=0;if($("#mbr_status_approved").attr("checked")==true){o=1}var a=0;if($("#mbr_status_confirmed").attr("checked")==true){a=1}var j=0;if($("#mbr_status_suspended").attr("checked")==true){j=1}var l={approved:o,confirmed:a,suspended:j};params_add_fields=_get_add_fields();var c=true;try{c=add_fields_validator.checkAll()}catch(i){}if(_validate_member_fields(n)&&c){var d=jQuery.extend(n,l,params_add_fields);on_post_success=after_save_account_info_success;on_post_error=after_save_account_info_error;load_panel(base_url+"member/edit_member_info",d)}}}catch(i){_sys_error("member_info_update:save_account_info","Collects account fields values for saving",i)}}function send_email_to_memeber(a){if(parseInt(a)>0){menu_click(4,2,base_url+"newsletter/send_email/"+a,{1:base_url+"js/admin/init.js"})}}function memeber_email_history(a){if(parseInt(a)>0){menu_click(4,3,base_url+"newsletter/history/"+a,{1:base_url+"js/admin/init.js"})}};
