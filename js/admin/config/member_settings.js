var validator;var selector;var temp_te=new Array();var temp_de=new Array();function myPanelOnLoad(){try{validator=new FormValidator();selector=new multiSelector();temp_vars_set=getTempVarsSet(temp_vars_set);validator.add("member_allow_register");validator.add("member_need_activation");validator.add("member_approve_needed");validator.add("member_force_billing_info_input");if($("#member_simple_menu").length>0){validator.add("member_simple_menu")}validator.add("member_email_as_login");validator.add("member_autosubscribe_free_products");validator.add("member_exp_subscr_notif_period","(check_int(val) && val.length<=3)||!val");validator.items.member_exp_subscr_notif_period.checkOnEvent("keyup");validator.add("denied_text","(duplicationEmail(val) && check_email_domain(val))||!val");validator.items.denied_text.checkOnEvent("keyup");validator.add("trust_text","(duplicationEmail(val) && check_email_domain(val))||!val");validator.items.trust_text.checkOnEvent("keyup");validator.checkAll();temp_te=selector.getAllItems("trustsel");temp_de=selector.getAllItems("deniedsel")}catch(a){alert("myTabOnLoad: "+a.message);_sys_error("Error:","FAIL",a)}}function duplicationEmail(a){for(key in temp_te){if(temp_te[key]==a){return false}}for(key in temp_de){if(temp_te[key]==a){return false}}return true}function myPanelDestructor(){validator=null;selector=null}function after_save(b){var a=getTempVarsSet(false,b);displayMessageEx(a)}function save_error(b){var a=getTempVarsSet(false,b);displayMessageEx(a,true)}function errorBoxControl(){try{var b=false;for(key in validator.items){if(typeof(validator.items[key])!="function"){b=validator.items[key].error.is_error?true:b}}if(!b){displayMessageEx(false,true);validator.setOnCheck()}}catch(a){alert("errorBoxControl: "+a.message)}}function addEmail(a){if(validator.items[a+"_text"].check()&&validator.items[a+"_text"].value!=""){selector.add(a+"sel",a+"_text")}temp_te=selector.getAllItems("trustsel");temp_de=selector.getAllItems("deniedsel")}function delEmail(a){selector.delSelected(a);temp_te=selector.getAllItems("trustsel");temp_de=selector.getAllItems("deniedsel")}function member_settings_save(c,b){try{if(b){if(confirm(temp_vars_set.cancelText)){var f={action:""};load_panel(c,f,{"0":base_url+"js/admin/init.js"})}}else{displayMessageEx();validator.items.trust_text.error.validation=false;validator.items.denied_text.error.validation=false;if(!validator.checkAll()){validator.items.trust_text.error.validation=true;validator.items.denied_text.error.validation=true;displayMessageEx("validation_fail",true);validator.setOnCheck(errorBoxControl)}else{var f={action:"save"};var a=validator.getItems();a.trusted_emails=selector.getAllItems("trustsel",",");a.denied_emails=selector.getAllItems("deniedsel",",");delete (a.denied_text);delete (a.trust_text);for(key in a){if(typeof(a[key])!="function"){f[key]=a[key]}}on_post_error=save_error;additional_accept=after_save;load_panel(c,f,{"0":base_url+"js/admin/init.js"})}}}catch(d){alert("Member_settings_save: "+d.message);_sys_error("Error:","FAIL",d)}};
