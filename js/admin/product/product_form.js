var product_free=false;function check_poster(){if($("#p_poster").val().length){try{var a=$("#p_poster").val();a=a.toLowerCase();return a.search(/(\.jpeg|\.jpg|\.gif)$/)!=-1}catch(b){_sys_error("product/product_form.js::_check_poster","checking ext.",b)}}else{return true}}function check_discount(a,c,b){if(b!=1){for(price in a){if(price<=c){return false}}}else{for(price in a){if(price<=c){return false}}}}function _get_min_price(b,a){if(a>0){if(b==0||a<b){return a}}return b}function check_inputs(){try{var c=new Array();c[0]=($("#p_p_day").val()?$("#p_p_day").val():0);c[1]=($("#p_p_month").val()?$("#p_p_month").val():0);c[2]=($("#p_p_month3").val()?$("#p_p_month3").val():0);c[3]=($("#p_p_month6").val()?$("#p_p_month6").val():0);c[4]=($("#p_p_year").val()?$("#p_p_year").val():0);c[5]=($("#p_p_year5").val()?$("#p_p_year5").val():0);var o=check_min_len($("#p_name").val(),1)&&check_max_len($("#p_name").val(),255)&&$("#p_name").val().match(/\S+/);var i=check_min_len($("#p_descr").val(),1)&&check_max_len($("#p_descr").val(),65535);var h=$("#p_groups").val()&&$("#p_groups").val().length&&$("#p_groups").val().length>=1;var m=$("#product_free").attr("checked")?1:0;var q=0;var n=true;if(m==0){var r=parseFloat($("#p_disc_value").val());var g=0;for(var a in c){if(typeof(c[a])!="function"){q--;c[a]=parseFloat(c[a]);if(c[a]==0){q++}else{m=1;if(check_amount(c[a])&&c[a]<=99999999.99){q++;g=_get_min_price(g,c[a])}}}}q=q==0?true:false;if(m){if(g<0.01){q=false;show_form_errors(6)}else{if($("#p_disc_type_percent").attr("checked")){g=g-g/100*r}else{g-=r}n=g>=0.01}}}else{q=true}var l=($("#p_trial_price").val().length?check_amount($("#p_trial_price").val()):true);var j=$("#p_trial_period_value").val().length?check_int($("#p_trial_period_value").val()):true;var k=true;var f=($("#p_disc_value").val().length?check_amount($("#p_disc_value").val()):true);if($("#p_product_type").val()==2){var b=$("#p_hosts").val()&&$("#p_hosts").val().length&&$("#p_hosts").val().length>=1}else{var b=true}if(!b){show_form_errors(15)}if(!o){show_form_errors(1)}if(!i){show_form_errors(4)}if(!h){show_form_errors(5)}if(!q){show_form_errors(6)}if(!l){show_form_errors(7)}if(!j){show_form_errors(8)}if(!f){show_form_errors(9)}if(!k){show_form_errors(10)}if(!m){show_form_errors(12)}if(!n){show_form_errors(13)}return o&&i&&h&&q&&l&&j&&f&&k&&m&&n&&b}catch(d){_sys_error("product/product_form.js::check_inputs","checking",d);return false}}function click_product_free(){product_free=$("#product_free").attr("checked")?true:false;$("#p_trial_price").attr("disabled",product_free);$("#p_trial_period_value").attr("disabled",product_free);$("#p_trial_period_type").attr("disabled",product_free);$("#p_cumulative").attr("disabled",product_free);$("#p_disc_type_percent").attr("disabled",product_free);$("#p_disc_type__val").attr("disabled",product_free);$("#p_disc_value").attr("disabled",product_free);$("#p_rec_yes").attr("disabled",product_free);$("#p_p_day").attr("disabled",product_free);$("#p_p_month").attr("disabled",product_free);$("#p_p_month3").attr("disabled",product_free);$("#p_p_month6").attr("disabled",product_free);$("#p_p_year").attr("disabled",product_free);$("#p_p_year5").attr("disabled",product_free)}function click_product_type(){try{var b=parseInt($("#p_product_type").val());$("#p_dirs").attr("disabled",(b!=1)?true:false);$("#p_hosts").attr("disabled",(b!=2)?true:false)}catch(a){_sys_error("click_product_type",print_r(a))}};
