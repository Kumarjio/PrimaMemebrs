function after_load_email_history_list_success(b){try{_change_accnt_panel_tab("tab_email_history");$("#account_panel").html(b)}catch(a){_sys_error("email_history:after_load_email_history_list_success","Shows member's email history list",a)}}function load_email_history_list(c){try{var a=$("#mbr_id").val();if(a>0){if(c){$.each(c,function(e,f){if(e=="ppage"&&!isNaN(f)){per_page=f;current_page=1}else{if(e=="cpage"){current_page=(f>0)?f:1}else{if(e=="ord"){sort_by=f;sort_how=(sort_how=="asc")?"desc":"asc"}}}return})}var d={user_id:a,cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};on_post_success=after_load_email_history_list_success;load_panel(base_url+"member/edit_member_email_history",d)}}catch(b){_sys_error("email_history:load_email_history_list","Prepares params for member's email history list",b)}}function on_success_before_reload_email_history(b){try{_change_accnt_panel_tab("tab_email_history");$("#account_panel").html(b)}catch(a){_sys_error("email_history:after_load_email_history_list_success","Shows member's email history list",a)}return}function after_delete_email_history_success(){try{var a=$("#mbr_id").val();if(a>0){var c={user_id:a,cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};on_post_success=on_success_before_reload_email_history;load_panel(base_url+"member/edit_member_email_history",c);return 1}}catch(b){_sys_error("email_history:after_delete_email_history_success","Prepares params for member's email history list",b)}}function after_delete_email_history_error(a){try{if(a!=""){displayMessageEx(a,true);show_error(a)}}catch(b){_sys_error("email_history:after_delete_email_history_error","Showing error after an attempt to delete member's email history ",b)}}function delete_email_history(d){try{if(d>0){var a=$("#delete_question").text();if(confirm(a)){var c={email_id:d};on_post_success=after_delete_email_history_success;on_post_error=after_delete_email_history_error;load_panel(base_url+"member/edit_member_rem_email_history",c)}}}catch(b){_sys_error("email_history:delete_email_history","Prepares email id before delete",b)}}function after_email_info_view_success(b){try{_change_accnt_panel_tab("tab_email_history");$("#account_panel").html(b)}catch(a){_sys_error("email_history:after_email_info_view_success","Shows member's email info",a)}}function after_email_info_view_error(a){try{if(a!=""){displayMessageEx(a,true);show_error(a)}}catch(b){_sys_error("email_history:after_email_info_view_error","Showing error after an attempt to view member's email info",b)}}function view_email_info(b){try{if(b>0){var c={email_id:b};on_post_success=after_email_info_view_success;on_post_error=after_email_info_view_error;load_panel(base_url+"member/edit_member_detail_history_view",c)}}catch(a){_sys_error("email_history:email_info_view","Prepares params before getting member's email info",a)}}function after_load_email_client_form_success_full(b){try{_change_accnt_panel_tab("tab_email_client");$("#account_panel").html(b)}catch(a){_sys_error("email_history:after_load_email_client_form_success","Shows email client form",a)}}function after_load_email_client_form_success_part(b){try{temp=b.split("!:sep:!");$("#subject").val(temp[0]);$("#message").val(temp[1])}catch(a){_sys_error("email_history:after_load_email_client_form_success","Shows email client form",a)}}function load_email_client_form(a){try{var b=$("#mbr_id").val();if(b>0){tid=$("#template").val();if(isNaN(tid)||tid<1){tid=1}var d={template_id:tid,member_id:b};if(a&&a=="tpl_change"){d=$.extend(d,{action:a});on_post_success=after_load_email_client_form_success_part}else{on_post_success=after_load_email_client_form_success_full}load_panel(base_url+"member/edit_member_email_client",d)}return}catch(c){_sys_error("email_history:load_email_client_form","Loads email client form",c)}};
