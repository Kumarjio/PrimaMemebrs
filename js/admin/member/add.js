function after_add_member_success(c){msg=c;after_panel_load=after_panel_loaded;try{var b={cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};load_panel(base_url+"member/member_list",b)}catch(a){_sys_error("add:after_add_member_success","Getting pager params",a)}}function after_add_member_error(b){var a=getTempVarsSet(false,b);if(a.length>0){displayMessageEx(a,true)}else{_msg_panel_hide();if(b!=""){_error_panel_show(b)}}}var validator;function myOnSave(){validator=new FormValidator();var a=$("table.table_pos").find(":input").not(".user_registration_add_field,:button");a.each(function(){validator.add($(this).attr("name"))});if(validator.checkAll()&&add_fields_validator.checkAll()){var b={action:"save"};var a=validator.getItems();for(key in a){if(typeof(a[key])!="function"){b[key]=a[key]}}b["groups[]"]=b.groups;delete (b.groups);b=jQuery.extend(b,_get_add_fields());on_post_error=panel_save_error;additional_accept=function(d){var c=getTempVarsSet(false,d);displayMessageEx(c);moveSlideTab("member_list")};load_panel(base_url+"member/add",b,{"0":base_url+"js/admin/init.js"})}}function add_member(){try{var o=$("#mbr_exp_date").val();var n=$("#mbr_email").val();var j=$("#mbr_login").val();var d=$("#mbr_first_name").val();var a=$("#mbr_last_name").val();var s=$("#mbr_groups").val();var h={exp_date:o,email:n,login:j,name:d,last_name:a,"groups[]":s,action:"add"};var c=0;if($("#mbr_status_approved").attr("checked")==true){c=1}var i=0;if($("#mbr_status_confirmed").attr("checked")==true){i=1}var f=0;if($("#mbr_status_suspended").attr("checked")==true){f=1}var m={status_approved:c,status_confirmed:i,status_suspended:f};var b="0";if($("#mbr_is_gen_pass").attr("checked")==true){b="1"}else{var l=$("#mbr_password1").val();var k=$("#mbr_password2").val();if(l==""||k==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();return}if(l!=k){$("#jsvalid_error_passwords_coincidence").show();$("#error_panel").show();return}if(check_user_pwd(l)<2){$("#jsvalid_error_password_wrong_chars").show();$("#error_panel").show();return}var p={pwd:l}}var r={generate_random:b};if(p){var g=jQuery.extend(r,p)}else{var g=r}params_add_fields=_get_add_fields();if(_validate_member_fields(h)){var t=jQuery.extend(h,g,m,params_add_fields);on_post_success=after_add_member_success;on_post_error=after_add_member_error;load_panel(base_url+"member/add",t)}}catch(q){_sys_error("add:add_member","Getting fields values",q)}};
