var error=null;var msg=null;var tab_bg_clr=null;var is_search=false;var search_letter=null;var search_by_key=null;var search_by_val=null;var search_date_from=null;var search_date_to=null;var search_date_period=null;var current_page=1;var per_page=0;var sort_by="by_login";var sort_how="asc";function _get_add_fields1(){try{var c=new Array;var a=new Array;var b=new Array;$.each($("[id^='user_registration_add_field_']"),function(e,f){if($(f).is("input[@type='checkbox']")&&$(f).attr("checked")==true){c.push($(f).attr("name"));a.push("1")}else{if($(f).is("input[@type='radio']")){if($(f).attr("checked")==true){c.push($(f).attr("name"));a.push($(f).val())}}else{c.push($(f).attr("name"));a.push($(f).val())}}b=jQuery.extend(b,{"add_fields_keys[]":c,"add_fields_values[]":a})});return b}catch(d){_sys_error("common:_get_add_fields","Collects additional fields values",d)}}function _get_add_fields(){try{var b=new Array;var a=new Array;$.each($(".user_registration_add_field"),function(d,e){if($(e).is(":checkbox")){if($(e).is(":checkbox:checked")){b.push($(e).attr("name").split("_")[2]);a.push($(e).val())}return}if($(e).is(":radio")){if($(e).is(":radio:checked")){b.push($(e).attr("name").split("_")[2]);a.push($(e).val())}return}if($(e).is("select")){if($(e).val()!=null){b.push(parseInt($(e).attr("name").split("_")[2]).toString());a.push($(e).val())}return}b.push($(e).attr("name").split("_")[2]);a.push($(e).val())});return{"add_fields_keys[]":b,"add_fields_values[]":a}}catch(c){_sys_error("common:_get_add_fields","Collects additional fields values",c)}}function _get_valid_reason(a){a=parseInt(a);if(isNaN(a)||a<0){a=0}return a}function _get_selected_members(){try{var a="";var c=[];var b=$("input[id^='mbr_id-']");for(i=0;i<b.length;i++){if($(b[i]).attr("checked")){c=$(b[i]).attr("id").split("-");if(c[1]>0){a=a+"!"+c[1]}}}a=a.substr(1)}catch(d){_sys_error("common:_get_selected_members","Getting members checkboxes which are checked",d)}return a}function set_checked_all(b){try{var a=$("input[id^='mbr_id-']");for(i=0;i<a.length;i++){if(!$(a[i]).attr("disabled")){if($("input[id='setall']").attr("checked")){$(a[i]).attr("checked","checked")}else{$(a[i]).attr("checked","")}}}}catch(c){_sys_error("common:set_checked_all","Check all checkboxes according id name",c)}}function gen_pass_reaction(){try{if($("#mbr_is_gen_pass").attr("checked")==true){$("#tr_password1").hide();$("#tr_password2").hide()}else{$("#tr_password1").show();$("#tr_password2").show()}}catch(a){_sys_error("common:gen_pass_reaction","Hides or shows password fields",a)}}function set_date_fromto(){try{$("#date_period option").removeAttr("selected");$("#date_period option[@value='all_time']").attr("selected","selected");search_date_period=null}catch(a){_sys_error("common:set_date_fromto","Changing date attributes",a)}}function after_member_unsuspend_list_success(c){msg=c;after_panel_load=after_panel_loaded;try{var b={cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};_set_menu_cursor("2","2");load_panel(base_url+"member/member_list",b)}catch(a){_sys_error("common:after_member_unsuspend_list_success","Loading member list after success",a)}}function after_member_unsuspend_success(c){msg=c;after_panel_load=after_panel_loaded;try{var b={cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};load_panel(base_url+"member/unsuspend",b)}catch(a){_sys_error("common:after_member_unsuspend_success","Loading suspended member list after success",a)}}function after_member_unsuspend_error(a){if(a!=""){_error_panel_show(a)}}function unsuspend_member_list(){try{var b=_get_selected_members();if(b==""){$("#jsvalid_error_mbr_notchecked").show();$("#error_panel").show();return false}var a=$("#unsuspend_question").text();if(confirm(a)){var d={mbrlist:b};on_post_success=after_member_unsuspend_success;on_post_error=after_member_unsuspend_error;load_panel(base_url+"member/unsuspend_user/",d)}}catch(c){_sys_error("common:unsuspend_member","select checked members id",c)}}function unsuspend_member(c,a){try{if(parseInt(c)>0){var b=$("#unsuspend_question").text();if(confirm(b)){var f={mbrlist:c+"!"};if(isset(a)){f.from_page="member_list";load_panel(base_url+"member/member_list/",f);return}else{on_post_success=after_member_unsuspend_success;on_post_error=after_member_unsuspend_error;load_panel(base_url+"member/unsuspend_user/",f);return}}}}catch(d){_sys_error("common:unsuspend_member","select checked members id",d)}}function _validate_member_fields(b){var c=true;try{$("div#error_panel").children(".box_err").hide();$.each(b,function(d,e){if(d=="login"){if(e==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();c=false;return}if(!check_max_len(e,32)){$("#jsvalid_error_login_toolong").show();$("#error_panel").show();c=false;return}if(!check_min_len(e,4)){$("#jsvalid_error_login_tooshort").show();$("#error_panel").show();c=false;return}if(!check_user_login(e)){$("#jsvalid_error_login_wrong_chars").show();$("#error_panel").show();c=false;return}}else{if(d=="exp_date"&&e!=""){if(!check_date(e)){$("#jsvalid_error_expdate_wrong").show();$("#error_panel").show();c=false;return}}else{if(d=="email"){if(e==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();c=false;return}if(!check_max_len(e,64)){$("#jsvalid_error_email_toolong").show();$("#error_panel").show();c=false;return}else{if(!check_mail(e)){$("#jsvalid_error_email_wrong").show();$("#error_panel").show();c=false;return}}}else{if(d=="name"){if(e==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();c=false;return}if(!check_max_len(e,32)){$("#jsvalid_error_first_name_toolong").show();$("#error_panel").show();c=false;return}}else{if(d=="last_name"){if(e==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();c=false;return}if(!check_max_len(e,32)){$("#jsvalid_error_last_name_toolong").show();$("#error_panel").show();c=false;return}}}}}}})}catch(a){_sys_error("common:validate_member_fields","Member add,edit form fields",a)}return c}function set_dp(){$("#date_from").bind("change",set_dp_limit);$("#date_from").bind("blur",set_dp_limit);$("#date_from").bind("select",set_dp_limit)}function set_dp_limit(){var c=datePickerController.datePickers.date_from.date;c.setDate(c.getDate()+1);c.getDate();var a=c.getMonth().toString().length<2?"0"+(c.getMonth()+1):(c.getMonth()+1);var b=c.getDate().toString().length<2?"0"+(c.getDate()):(c.getDate());datePickerController.datePickers.date_to.setRangeLow(c.getFullYear()+a+b);c=new Date();var a=c.getMonth().toString().length<2?"0"+(c.getMonth()+1):(c.getMonth()+1);var b=c.getDate().toString().length<2?"0"+(c.getDate()):(c.getDate());datePickerController.datePickers.date_to.setRangeHigh(c.getFullYear()+a+b)};
