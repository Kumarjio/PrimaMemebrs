function after_email_client_send_success(a){msg=a;after_panel_load=after_panel_loaded;_error_panel_hide();_msg_panel_show(msg)}function after_email_client_send_error(a){_msg_panel_hide();if(a!=""){_error_panel_show(a)}}function email_client_send(){_msg_panel_hide();try{var d=$("#mbr_id").val();if(d>0){var g=$("#template").val();var a=$("#from").val();var c=$("#subject").val();var b=$("#message").val();var h={member_id:d,template_id:g,from:a,subject:c,msg:b,action:"send"};if(_validate_email_client_fields(h)){on_post_success=after_email_client_send_success;on_post_error=after_email_client_send_error;load_panel(base_url+"member/edit_member_email_client",h);return false}return}}catch(f){_sys_error("email_client:email_client_send","Prepares params for email client",f)}}function _validate_email_client_fields(b){var c=true;try{$("div#error_panel").children(".box_err").hide();$.each(b,function(d,e){if(e==""){$("#jsvalid_error_fields_empty").show();$("#error_panel").show();c=false;return}else{if(d=="template_id"){if(e<1){$("#jsvalid_error_template_id_wrong").show();$("#error_panel").show();c=false;return}}else{if(d=="from"){if(!check_max_len(e,50)){$("#jsvalid_error_from_toolong").show();$("#error_panel").show();c=false;return}else{if(!check_mail(e)){$("#jsvalid_error_from_wrong").show();$("#error_panel").show();c=false;return}}}else{if(d=="subject"){if(!check_max_len(e,254)){$("#jsvalid_error_subject_toolong").show();$("#error_panel").show();c=false;return}}else{if(d=="msg"){if(!check_max_len(e,65536)){$("#jsvalid_error_msg_toolong").show();$("#error_panel").show();c=false;return}}}}}}})}catch(a){_sys_error("email_client:validate_email_client_fields","Validate email client params",a)}return c};
