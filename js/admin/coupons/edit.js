function after_load_coupons_edit_form_error(a){_msg_panel_hide();if(a!=""){_error_panel_show(a)}}function load_coupons_edit_form(a){try{if(a>0){var c={id:a};on_post_error=after_load_coupons_edit_form_error;document.location.hash=document.location.hash+"/"+a+"/edit";load_panel(base_url+"coupons/edit",c);return}}catch(b){_sys_error("edit:load_coupons_edit_form","Loads coupons group form for update",b)}}function after_save_coupons_group_success(c){msg=c;after_panel_load=after_panel_loaded;try{var b={cpage:current_page,ppage:per_page,ord:sort_by,ord_type:sort_how};moveSlideTab(5,1,"coupon_groups");load_panel(base_url+"coupons/coupons_list",b)}catch(a){_sys_error("edit:after_save_coupons_group_success","Getting pager params for coupons group list",a)}}function after_save_coupons_group_error(a){_msg_panel_hide();if(a!=""){_error_panel_show(a)}}function save_coupons_group(g){_msg_panel_hide();_error_panel_hide();try{if(g>0){var k=$("#coupons_name").val();var l=$("#use_count").val();var c=$("#mbr_use_count").val();var o=$("#discount_val").val();var a=$("#discount_type").val();var h=$("#descr").val();var i=""+$("#products").val();if(i!="null"){i=i.replace(/[,]/g,"!")}else{i=""}var m=0;if($("#locked").attr("checked")==true){m=1}var d={id:g,name:k,descr:h,per_user_use:c,coupon_use:l,discount_val:o,discount_type:a,locked:m,products:i,action:"save"};var p=0;if($("#no_dates_limit").attr("checked")==true){p=1}else{var n=$("#start_date").val();var b=$("#end_date").val();if(!check_date(n)||!check_date(b)){$("#jsvalid_error_date_wrong").show();$("#error_panel").show();return false}if(!compare_dates(n,b)){$("#jsvalid_error_dates_compare").show();$("#error_panel").show();return false}var f={start_date:n,end_date:b};d=jQuery.extend(d,f)}d=jQuery.extend(d,{donot_limit_dates:p});if(_validate_coupons_fields(d)){on_post_success=after_save_coupons_group_success;on_post_error=after_save_coupons_group_error;load_panel(base_url+"coupons/edit",d)}}}catch(j){_sys_error("edit:save_coupons_group","Collects coupons group fields values for updating",j)}};
